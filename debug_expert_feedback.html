<!DOCTYPE html>
<html>
<head>
    <title>Debug Expert Feedback Flow</title>
</head>
<body>
    <h1>Debug Expert Feedback Flow</h1>
    <div id="debug-output"></div>
    
    <script>
        function debug(message) {
            console.log(message);
            const output = document.getElementById('debug-output');
            output.innerHTML += '<div>' + message + '</div>';
        }
        
        // Test the JavaScript function exposure
        debug("üîç Testing JavaScript Function Exposure:");
        debug("window.buildModalNavigationList: " + (typeof window.buildModalNavigationList));
        debug("window.updateNavigationButtons: " + (typeof window.updateNavigationButtons));
        debug("window.populateResultsTable: " + (typeof window.populateResultsTable));
        debug("window.resetFilterState: " + (typeof window.resetFilterState));
        
        // Test current analysis results
        debug("\nüîç Testing Current Analysis Results:");
        debug("window.currentAnalysisResults exists: " + (!!window.currentAnalysisResults));
        
        if (window.currentAnalysisResults && window.currentAnalysisResults.individual_results) {
            const wellCount = Object.keys(window.currentAnalysisResults.individual_results).length;
            debug("Wells in currentAnalysisResults: " + wellCount);
            
            // Show first few wells
            const wellKeys = Object.keys(window.currentAnalysisResults.individual_results).slice(0, 5);
            debug("First 5 wells: " + wellKeys.join(", "));
            
            // Check for expert feedback
            let expertFeedbackCount = 0;
            for (const [wellKey, wellData] of Object.entries(window.currentAnalysisResults.individual_results)) {
                if (wellData.curve_classification && wellData.curve_classification.method === 'expert_feedback') {
                    expertFeedbackCount++;
                }
            }
            debug("Wells with expert feedback: " + expertFeedbackCount);
        }
        
        // Test table state
        debug("\nüîç Testing Table State:");
        const tableRows = document.querySelectorAll('#resultsTableBody tr');
        debug("Table rows found: " + tableRows.length);
        
        let visibleRows = 0;
        tableRows.forEach(row => {
            if (row.style.display !== 'none') {
                visibleRows++;
            }
        });
        debug("Visible table rows: " + visibleRows);
        
        // Test modal navigation
        debug("\nüîç Testing Modal Navigation:");
        if (window.modalNavigationList) {
            debug("Modal navigation items: " + window.modalNavigationList.length);
        } else {
            debug("Modal navigation not initialized");
        }
        
        // Test session ID
        debug("\nüîç Testing Session ID:");
        debug("window.currentSessionId: " + (window.currentSessionId || "not set"));
        if (window.currentAnalysisResults && window.currentAnalysisResults.session_id) {
            debug("Analysis results session_id: " + window.currentAnalysisResults.session_id);
        }
        
        // Test ML feedback interface
        debug("\nüîç Testing ML Feedback Interface:");
        debug("window.mlFeedbackInterface exists: " + (!!window.mlFeedbackInterface));
        if (window.mlFeedbackInterface) {
            debug("Current well key: " + (window.mlFeedbackInterface.currentWellKey || "not set"));
            debug("Current well data exists: " + (!!window.mlFeedbackInterface.currentWellData));
        }
    </script>
</body>
</html>
